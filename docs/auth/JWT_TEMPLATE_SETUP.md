# JWTãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¨­å®šå®Œäº†ã‚¬ã‚¤ãƒ‰

## âœ… å®Œäº†ã—ãŸä½œæ¥­

Turso CLIã‚’ä½¿ç”¨ã—ã¦JWTãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚

**ç”Ÿæˆã•ã‚ŒãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆID**: `1d998095-2388-4f69-be00-16fc0614e313`

## ğŸ“‹ è¨­å®šã•ã‚ŒãŸæ¨©é™

### ãƒ¦ãƒ¼ã‚¶ãƒ¼å›ºæœ‰ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«

- **`words`**: èª­ã¿å–ã‚Šã€è¿½åŠ ã€æ›´æ–°ã€å‰Šé™¤
- **`aggregated_stats`**: èª­ã¿å–ã‚Šã€æ›´æ–°
- **`settings`**: èª­ã¿å–ã‚Šã€æ›´æ–°
- **`game_scores`**: èª­ã¿å–ã‚Šã€è¿½åŠ 
- **`user_presets`**: èª­ã¿å–ã‚Šã€è¿½åŠ ã€æ›´æ–°ã€å‰Šé™¤
- **`user_preset_words`**: èª­ã¿å–ã‚Šã€è¿½åŠ ã€æ›´æ–°ã€å‰Šé™¤

### ã‚·ã‚¹ãƒ†ãƒ å…±æœ‰ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«

- **`presets`**: èª­ã¿å–ã‚Šã®ã¿
- **`preset_words`**: èª­ã¿å–ã‚Šã®ã¿

## ğŸ”§ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### 1. Clerkãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§JWTãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆ

1. [Clerk Dashboard](https://dashboard.clerk.com/)ã«ãƒ­ã‚°ã‚¤ãƒ³
2. å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‹ã‚‰ **JWT Templates** ã‚’é¸æŠ
3. **Create Template** ã‚’ã‚¯ãƒªãƒƒã‚¯
4. ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåã‚’å…¥åŠ›ï¼ˆä¾‹: `turso-database-access`ï¼‰
5. **Claims** ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ä»¥ä¸‹ã®JSONã‚’è²¼ã‚Šä»˜ã‘:

```json
{
  "a": "rw",
  "id": "1d998095-2388-4f69-be00-16fc0614e313",
  "perm": [
    {
      "t": ["words"],
      "a": ["data_read", "data_add", "data_update", "data_delete"]
    },
    {
      "t": ["aggregated_stats"],
      "a": ["data_read", "data_update"]
    },
    {
      "t": ["settings"],
      "a": ["data_read", "data_update"]
    },
    {
      "t": ["game_scores"],
      "a": ["data_read", "data_add"]
    },
    {
      "t": ["user_presets"],
      "a": ["data_read", "data_add", "data_update", "data_delete"]
    },
    {
      "t": ["user_preset_words"],
      "a": ["data_read", "data_add", "data_update", "data_delete"]
    },
    {
      "t": ["presets"],
      "a": ["data_read"]
    },
    {
      "t": ["preset_words"],
      "a": ["data_read"]
    }
  ],
  "rid": "d54214ca-4d03-4aea-a505-f20eec1ddad5"
}
```

6. **Save** ã‚’ã‚¯ãƒªãƒƒã‚¯

### 2. Clerkã®JWKSã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURLã‚’å–å¾—

1. Clerkãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ **API Keys** ã‚’é¸æŠ
2. **Frontend API** ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®URLã‚’ç¢ºèª
3. JWKSã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURLã¯ä»¥ä¸‹ã®å½¢å¼:

   ```
   https://<your-app>.clerk.accounts.dev/.well-known/jwks.json

   ```

   ä¾‹: `https://your-app.clerk.accounts.dev/.well-known/jwks.json`

### 3. JWKSã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’Tursoã«è¿½åŠ  âœ… å®Œäº†

```bash
turso org jwks save clerk https://vast-whale-1.clerk.accounts.dev/.well-known/jwks.json
```

**è¨­å®šæ¸ˆã¿**: `clerk` â†’ `https://vast-whale-1.clerk.accounts.dev/.well-known/jwks.json`

### 4. JWKSã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ç¢ºèª

è¿½åŠ ã•ã‚ŒãŸJWKSã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç¢ºèª:

```bash
turso org jwks list
```

## ğŸ“ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«

ç”Ÿæˆã•ã‚ŒãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™:

- `docs/turso-jwt-template.json`

## âš ï¸ æ³¨æ„äº‹é …

1. **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆID**: ç”Ÿæˆã•ã‚ŒãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆID (`1d998095-2388-4f69-be00-16fc0614e313`) ã¯ã€Clerkã®JWTãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
2. **ãƒªã‚½ãƒ¼ã‚¹ID**: `rid` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ (`d54214ca-4d03-4aea-a505-f20eec1ddad5`) ã¯ã€Tursoã®ãƒªã‚½ãƒ¼ã‚¹IDã§ã™
3. **æ¨©é™ã®å¤‰æ›´**: å°†æ¥çš„ã«æ¨©é™ã‚’å¤‰æ›´ã™ã‚‹å ´åˆã¯ã€æ–°ã—ã„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¦Clerkã®è¨­å®šã‚’æ›´æ–°ã—ã¦ãã ã•ã„

## ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### JWKSã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒè¿½åŠ ã§ããªã„å ´åˆ

1. Clerkã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³URLãŒæ­£ã—ã„ã‹ç¢ºèª
2. JWKSã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆURLãŒæ­£ã—ã„å½¢å¼ã‹ç¢ºèª
3. Turso CLIãŒæœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‹ç¢ºèª: `turso --version`

### æ¨©é™ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å ´åˆ

1. Clerkã®JWTãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
2. JWKSã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒTursoã«æ­£ã—ãè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª: `turso org jwks list`
3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ä½¿ç”¨ã—ã¦ã„ã‚‹Clerkã®JWTãƒˆãƒ¼ã‚¯ãƒ³ãŒæ­£ã—ãå–å¾—ã§ãã¦ã„ã‚‹ã‹ç¢ºèª
